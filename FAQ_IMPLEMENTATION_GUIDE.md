# FAQデータベース実装ガイド

## 📊 NotionでのFAQデータベース作成手順

### ステップ1: 新しいデータベースの作成

1. CafeKinesiページ内で「/database」と入力
2. 「Table - Full page」を選択
3. データベース名を「FAQマスター」に設定

### ステップ2: プロパティの設定

#### プロパティ一覧：

| プロパティ名 | タイプ | 説明 |
|------------|--------|------|
| 質問 | Title | FAQの質問文 |
| 回答 | Text | 質問に対する回答 |
| カテゴリ | Select | FAQの分類 |
| 優先度 | Number | 表示順（1-10） |
| 公開 | Checkbox | 公開/非公開 |
| タグ | Multi-select | 追加ラベル |
| 更新日 | Last edited time | 自動更新 |

#### カテゴリの選択肢：
- 基本情報
- 講座について  
- 資格について
- 費用について
- その他

#### タグの選択肢：
- 初心者向け
- 人気
- 重要
- NEW

### ステップ3: ダミーFAQデータの追加

#### サンプルFAQデータ：

1. **質問**: カフェキネシとは何ですか？
   - **回答**: カフェキネシは、アロマセラピーとキネシオロジーを組み合わせた革新的なセラピーです。
   - **カテゴリ**: 基本情報
   - **優先度**: 1
   - **公開**: ✅
   - **タグ**: 初心者向け, 人気

2. **質問**: 講座の所要時間は？
   - **回答**: 約2時間で資格取得が可能です。
   - **カテゴリ**: 講座について
   - **優先度**: 2
   - **公開**: ✅
   - **タグ**: 重要

3. **質問**: オンライン受講は可能ですか？
   - **回答**: はい、Zoomを使用したオンライン講座も対応しています。
   - **カテゴリ**: 講座について
   - **優先度**: 3
   - **公開**: ✅
   - **タグ**: NEW

4. **質問**: 資格の有効期限は？
   - **回答**: 一度取得した資格は永久に有効です。
   - **カテゴリ**: 資格について
   - **優先度**: 4
   - **公開**: ✅
   - **タグ**: 重要

5. **質問**: 講座料金はいくらですか？
   - **回答**: 講座料金は2万円〜3万円程度です。
   - **カテゴリ**: 費用について
   - **優先度**: 5
   - **公開**: ✅
   - **タグ**: 人気

### ステップ4: ビューの設定

#### ⚠️ 重要: 公開プロパティのチェックボックスについて

Notionのチェックボックスプロパティは、APIで以下の値を返します：
- チェック済み（✓）: `"Yes"` として取得される
- 未チェック（□）: `undefined` または空の値として取得される

**実装時の注意点:**
```javascript
// 正しい実装（公開されたアイテムのみ表示）
const publicItems = items.filter(item => 
  item.properties.公開?.checkbox === true
);

// 誤った実装（公開されていないアイテムが表示される）
const publicItems = items.filter(item => 
  !item.properties.公開?.checkbox  // ← これは逆！
);
```

#### 1. 公開ビュー（ギャラリー）

1. ビューを追加 → 「ギャラリー」を選択
2. ビュー名を「公開FAQ」に設定
3. フィルター設定:
   - 「公開」がチェックされている（✓の状態）
4. グループ設定:
   - 「カテゴリ」でグループ化
5. ソート設定:
   - 「優先度」昇順

#### 2. 管理ビュー（テーブル）

1. ビューを追加 → 「テーブル」を選択
2. ビュー名を「管理用」に設定
3. すべてのプロパティを表示
4. ソート: 「更新日」降順

### ステップ5: ページへの配置

#### メインページへの埋め込み:

1. CafeKinesiホームページを開く
2. FAQセクションを追加したい場所で「/」を入力
3. 「Linked view of database」を選択
4. 「FAQマスター」を選択
5. ビューを「公開FAQ」に設定

#### セクションタイトルの追加:

1. データベースビューの上に新しいブロックを追加
2. 「## よくある質問」と入力

### ステップ6: 同期ブロック化（オプション）

他のページでも同じFAQを表示したい場合:

1. FAQセクション全体を選択
2. 右クリックで「同期ブロックを作成」
3. 他のページに「/」で同期ブロックを追加

## 🌐 React側の対応

### CollectionViewWrapperの活用

NotionのFAQデータベースは、React側で自動的に:

1. `CollectionViewWrapper`コンポーネントでレンダリング
2. ギャラリービューとして表示
3. CSSでスタイリング済み

### アコーディオン化の方法

Notionのトグルブロックを使用:

1. 各FAQアイテムの回答部分をトグルブロックに
2. トグルのタイトルに質問文を設定
3. トグル内に回答を記載

## 🔧 トラブルシューティング

### FAQが表示されない場合:

1. データベースの共有設定を確認
2. ビューのフィルター設定を確認
3. 公開プロパティがチェックされているか確認
4. APIでのチェックボックス値の取得方法を確認:
   ```javascript
   // テストスクリプトを実行
   node test-faq-checkbox.js
   ```

### チェックボックスのフィルタリングが正しく動作しない場合:

1. APIレスポンスの生の値を確認
2. チェックボックスの値が `"Yes"` になっているか確認
3. フィルター条件が正しいか確認（`=== true` ではなく `=== 'Yes'` の場合もある）

### ギャラリービューが崩れる場合:

1. `instructor-gallery-responsive.css`の読み込み確認
2. カードサイズの調整
3. ビューのレイアウト設定を確認

## ✅ 実装確認チェックリスト

- [ ] FAQデータベース作成
- [ ] プロパティ設定完了
- [ ] ダミーFAQ 5件以上追加
- [ ] 公開ビュー設定完了
- [ ] メインページへの配置
- [ ] 表示確認
- [ ] レスポンシブ確認
- [ ] 公開/非公開のフィルタリングが正しく動作することを確認

---

*このガイドに従ってNotionでFAQを実装することで、LLMO対策に有効な構造化されたFAQセクションが完成します。*